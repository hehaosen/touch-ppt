"use strict";var touchPPT=function(PPTarr,isVertical){var W=window,D=document,self=this,orderArr=[],nowPage=0,actors=[],film={};isVertical=isVertical+""=="undefined"?true:isVertical;var DW,DH;this.dom=function(_name){return D.querySelector(_name)};this.initializeCss=function(){D.getElementsByTagName("body")[0].style.cssText="overflow:hidden;display:block;visibility:visible";DW=D.body.clientWidth;DH=D.body.clientHeight};this.touchListener=function(){var _x,_y;D.getElementsByTagName("body")[0].addEventListener("touchstart",function(e){e.preventDefault();_x=e.touches[0].clientX;_y=e.touches[0].clientY});D.getElementsByTagName("body")[0].addEventListener("touchmove",function(e){e.preventDefault();if(isVertical){if(nowPage==0){if((e.touches[0].clientY-_y)<0){[orderArr[nowPage]][0].cssArr["top"]=-(_y-e.touches[0].clientY)+"px";[orderArr[nowPage+1]][0].cssArr["top"]=-(_y-e.touches[0].clientY)+DH+"px";[orderArr[nowPage+1]][0].cssArr["visibility"]="visible";[orderArr[nowPage+1]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage+1])}}else{if(nowPage==(orderArr.length-1)){if((_y-e.touches[0].clientY)<0){[orderArr[nowPage]][0].cssArr["top"]=-(_y-e.touches[0].clientY)+"px";[orderArr[nowPage-1]][0].cssArr["top"]=-(_y-e.touches[0].clientY)-DH+"px";[orderArr[nowPage-1]][0].cssArr["visibility"]="visible";[orderArr[nowPage-1]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage-1])}}else{[orderArr[nowPage]][0].cssArr["top"]=-(_y-e.touches[0].clientY)+"px";[orderArr[nowPage+1]][0].cssArr["top"]=-(_y-e.touches[0].clientY)+DH+"px";[orderArr[nowPage+1]][0].cssArr["visibility"]="visible";[orderArr[nowPage+1]][0].cssArr["display"]="block";[orderArr[nowPage-1]][0].cssArr["top"]=-(_y-e.touches[0].clientY)-DH+"px";[orderArr[nowPage-1]][0].cssArr["visibility"]="visible";[orderArr[nowPage-1]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage+1]);self.instantiationCss(orderArr[nowPage-1])}}self.instantiationCss(orderArr[nowPage])}else{if(nowPage==0){if((e.touches[0].clientX-_x)<0){[orderArr[nowPage]][0].cssArr["left"]=-(_x-e.touches[0].clientX)+"px";[orderArr[nowPage+1]][0].cssArr["left"]=-(_x-e.touches[0].clientX)+DW+"px";[orderArr[nowPage+1]][0].cssArr["visibility"]="visible";[orderArr[nowPage+1]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage+1])}}else{if(nowPage==(orderArr.length-1)){if((_x-e.touches[0].clientX)<0){[orderArr[nowPage]][0].cssArr["left"]=-(_x-e.touches[0].clientX)+"px";[orderArr[nowPage-1]][0].cssArr["left"]=-(_x-e.touches[0].clientX)-DW+"px";[orderArr[nowPage-1]][0].cssArr["visibility"]="visible";[orderArr[nowPage-1]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage-1])}}else{[orderArr[nowPage]][0].cssArr["left"]=-(_x-e.touches[0].clientX)+"px";[orderArr[nowPage+1]][0].cssArr["left"]=-(_x-e.touches[0].clientX)+DW+"px";[orderArr[nowPage+1]][0].cssArr["visibility"]="visible";[orderArr[nowPage+1]][0].cssArr["display"]="block";[orderArr[nowPage-1]][0].cssArr["left"]=-(_x-e.touches[0].clientX)-DW+"px";[orderArr[nowPage-1]][0].cssArr["visibility"]="visible";[orderArr[nowPage-1]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage+1]);self.instantiationCss(orderArr[nowPage-1])}}self.instantiationCss(orderArr[nowPage])}});D.getElementsByTagName("body")[0].addEventListener("touchend",function(e){e.preventDefault();if(isVertical){if(_y-e.changedTouches[0].clientY>=DH/3){self.nextPage()}else{if(_y-e.changedTouches[0].clientY<-DH/3){self.previousPage()}else{[orderArr[nowPage]][0].cssArr["top"]="0";if(nowPage!=0){[orderArr[nowPage-1]][0].cssArr["visibility"]="hidden";[orderArr[nowPage-1]][0].cssArr["display"]="none";self.instantiationCss(orderArr[nowPage-1])}if(nowPage!=(orderArr.length-1)){[orderArr[nowPage+1]][0].cssArr["visibility"]="hidden";[orderArr[nowPage+1]][0].cssArr["display"]="none";self.instantiationCss(orderArr[nowPage+1])}self.instantiationCss(orderArr[nowPage])}}}else{if(_x-e.changedTouches[0].clientX>=DW/3){self.nextPage()}else{if(_x-e.changedTouches[0].clientX<-DW/3){self.previousPage()}else{[orderArr[nowPage]][0].cssArr["left"]="0";if(nowPage!=0){[orderArr[nowPage-1]][0].cssArr["visibility"]="hidden";[orderArr[nowPage-1]][0].cssArr["display"]="none";self.instantiationCss(orderArr[nowPage-1])}if(nowPage!=(orderArr.length-1)){[orderArr[nowPage+1]][0].cssArr["visibility"]="hidden";[orderArr[nowPage+1]][0].cssArr["display"]="none";self.instantiationCss(orderArr[nowPage+1])}self.instantiationCss(orderArr[nowPage])}}}})};this.previousPage=function(){if(nowPage>0){[orderArr[nowPage]][0].cssArr["visibility"]="hidden";[orderArr[nowPage]][0].cssArr["display"]="none";[orderArr[nowPage]][0].cssArr["top"]="0";[orderArr[nowPage]][0].cssArr["left"]="0";self.instantiationCss(orderArr[nowPage]);nowPage--;[orderArr[nowPage]][0].cssArr["top"]="0";[orderArr[nowPage]][0].cssArr["left"]="0";[orderArr[nowPage]][0].cssArr["visibility"]="visible";[orderArr[nowPage]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage]);
	timer=0}else{[orderArr[nowPage]][0].cssArr["top"]="0";self.instantiationCss(orderArr[nowPage])}};this.nextPage=function(){if(nowPage!=(orderArr.length-1)){[orderArr[nowPage]][0].cssArr["visibility"]="hidden";[orderArr[nowPage]][0].cssArr["display"]="none";[orderArr[nowPage]][0].cssArr["top"]="0";[orderArr[nowPage]][0].cssArr["left"]="0";self.instantiationCss(orderArr[nowPage]);nowPage++;[orderArr[nowPage]][0].cssArr["visibility"]="visible";[orderArr[nowPage]][0].cssArr["top"]="0";[orderArr[nowPage]][0].cssArr["left"]="0";[orderArr[nowPage]][0].cssArr["display"]="block";self.instantiationCss(orderArr[nowPage]);timer=0}else{[orderArr[nowPage]][0].cssArr["top"]="0";[orderArr[nowPage]][0].cssArr["left"]="0";self.instantiationCss(orderArr[nowPage])}};this.instantiationCss=function(arr){var cssText="";for(var i in [arr][0].cssArr){cssText+=i+":"+[arr][0].cssArr[i]+";"}arr.style.cssText=cssText};this.instantiationAnimation=function(arr){var cssText="";for(var i in [arr][0].animationArr){cssText+=i+":"+[arr][0].animationArr[i]+";"}arr.style.cssText=cssText};this.story=function(){var _i=0;for(var _scene in PPTarr){orderArr[_i]=self.dom(_scene);orderArr[_i].cssArr={};actors[_i]=[];if(_i!=0){orderArr[_i].cssArr["visibility"]="hidden"}orderArr[_i].cssArr["position"]="fixed";orderArr[_i].cssArr["top"]="0";orderArr[_i].cssArr["left"]="0";orderArr[_i].cssArr["z-index"]=100-_i;orderArr[_i].cssArr["overflow"]="hidden";self.instantiationCss(orderArr[_i]);film[_i]={};for(var _actor in PPTarr[_scene]){self.makeActors(_actor,_i,_scene,PPTarr[_scene][_actor].type,PPTarr[_scene][_actor].speed,PPTarr[_scene][_actor].route)}_i++}};this.makeActors=function(_name,_scene,_father,_type,_speed,_route){var _actor=self.dom(_name);_type=_type?_type:"";_speed=typeof _speed==="number"?_speed:1000;_route=_route?_route:0;var _newActorNode=_actor.cloneNode(true);_newActorNode.className+=" PPT#"+_scene+"#"+(actors[_scene].length);self.dom(_father).appendChild(_newActorNode);_actor.id="old_"+_actor.id;film[_scene]=film[_scene]?film[_scene]:{};film[_scene][_route]=film[_scene][_route]?film[_scene][_route]:[];film[_scene][_route].push(actors[_scene].length);actors[_scene].push(_newActorNode);var _my=actors[_scene][actors[_scene].length-1];_my.cssArr={};_my.cssArr["position"]="absolute";_my.cssArr["top"]=_actor.offsetTop+"px";_my.cssArr["left"]=_actor.offsetLeft+"px";_my.cssArr["transition"]="all "+(_speed/1000)+"s ease";_my.cssArr["margin"]="0";_my.animationArr={};_my.animationArr["margin"]="0";if(_type.indexOf("join-top")!=-1){_my.animationArr["top"]="-"+_actor.offsetHeight+"px"}else{if(_type.indexOf("join-bottom")!=-1){_my.animationArr["top"]=DH+_actor.offsetHeight+"px"}else{if(_type.indexOf("out-top")!=-1){_my.animationArr["top"]=_my.cssArr["top"];_my.cssArr["top"]="-"+_actor.offsetHeight+"px"}else{if(_type.indexOf("out-bottom")!=-1){_my.animationArr["top"]=_my.cssArr["top"];_my.cssArr["top"]=DH+_actor.offsetHeight+"px"}else{_my.animationArr["top"]=_my.cssArr["top"]}}}}if(_type.indexOf("join-left")!=-1){_my.animationArr["left"]="-"+_actor.offsetWidth+"px"}else{if(_type.indexOf("join-right")!=-1){_my.animationArr["left"]=DW+_actor.offsetWidth+"px"}else{if(_type.indexOf("out-left")!=-1){_my.animationArr["left"]=_my.cssArr["left"];_my.cssArr["left"]="-"+_actor.offsetWidth+"px"}else{if(_type.indexOf("out-right")!=-1){_my.animationArr["left"]=_my.cssArr["left"];_my.cssArr["left"]=DW+_actor.offsetWidth+"px"}else{_my.animationArr["left"]=_my.cssArr["left"]}}}}if(_type.indexOf("join-hiding")!=-1){_my.animationArr["filter"]="alpha(opacity=0)";_my.animationArr["-moz-opacity"]="0";_my.animationArr["opacity"]="0"}if(_type.indexOf("out-hiding")!=-1){_my.cssArr["filter"]="alpha(opacity=0)";_my.cssArr["-moz-opacity"]="0";_my.cssArr["opacity"]="0"}_my.animationArr["position"]="absolute";self.instantiationAnimation(_my);_actor.style.cssText=_actor.style.cssText+"visibility:hidden; width:"+_actor.offsetWidth+"px; height:"+_actor.offsetHeight+"px";_actor.innerHTML=""};var timer=0;this.play=function(){function main(){return function(){if(film[nowPage][timer]!="undefined"){for(var i in film[nowPage][timer]){self.instantiationCss(actors[nowPage][film[nowPage][timer][i]])}}timer++}}setInterval(main(),100)};this.touchListener();this.initializeCss();this.story();this.play()};