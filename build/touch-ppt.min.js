/*!
 * 无依赖 轻量级 移动端ppt展现 v0.0.1
 * Date: 2016-4-22
 * author:大力神
 * http://www.github.com/hehaosen
 */
"use strict";var touchPPT=function(d,j){var e=window,a=document,l=this,i=[],f=0,g=[],k={};j=j?true:false;var h,c;this.dom=function(m){return a.querySelector(m)};this.initializeCss=function(){a.getElementsByTagName("body")[0].style.cssText="overflow:hidden;display:block;visibility:visible";h=a.body.clientWidth;c=a.body.clientHeight};this.touchListener=function(){var n,m;a.getElementsByTagName("body")[0].addEventListener("touchstart",function(o){o.preventDefault();n=o.touches[0].clientX;m=o.touches[0].clientY});a.getElementsByTagName("body")[0].addEventListener("touchmove",function(o){o.preventDefault();if(j){if(f==0){if((o.touches[0].clientY-m)<0){[i[f]][0].cssArr["top"]=-(m-o.touches[0].clientY)+"px";[i[f+1]][0].cssArr["top"]=-(m-o.touches[0].clientY)+c+"px";[i[f+1]][0].cssArr["visibility"]="visible";[i[f+1]][0].cssArr["display"]="block";l.instantiationCss(i[f+1])}}else{if(f==(i.length-1)){if((m-o.touches[0].clientY)<0){[i[f]][0].cssArr["top"]=-(m-o.touches[0].clientY)+"px";[i[f-1]][0].cssArr["top"]=-(m-o.touches[0].clientY)-c+"px";[i[f-1]][0].cssArr["visibility"]="visible";[i[f-1]][0].cssArr["display"]="block";l.instantiationCss(i[f-1])}}else{[i[f]][0].cssArr["top"]=-(m-o.touches[0].clientY)+"px";[i[f+1]][0].cssArr["top"]=-(m-o.touches[0].clientY)+c+"px";[i[f+1]][0].cssArr["visibility"]="visible";[i[f+1]][0].cssArr["display"]="block";[i[f-1]][0].cssArr["top"]=-(m-o.touches[0].clientY)-c+"px";[i[f-1]][0].cssArr["visibility"]="visible";[i[f-1]][0].cssArr["display"]="block";l.instantiationCss(i[f+1]);l.instantiationCss(i[f-1])}}l.instantiationCss(i[f])}else{if(f==0){if((o.touches[0].clientX-n)<0){[i[f]][0].cssArr["left"]=-(n-o.touches[0].clientX)+"px";[i[f+1]][0].cssArr["left"]=-(n-o.touches[0].clientX)+h+"px";[i[f+1]][0].cssArr["visibility"]="visible";[i[f+1]][0].cssArr["display"]="block";l.instantiationCss(i[f+1])}}else{if(f==(i.length-1)){if((n-o.touches[0].clientX)<0){[i[f]][0].cssArr["left"]=-(m-o.touches[0].clientX)+"px";[i[f-1]][0].cssArr["left"]=-(m-o.touches[0].clientX)-h+"px";[i[f-1]][0].cssArr["visibility"]="visible";[i[f-1]][0].cssArr["display"]="block";l.instantiationCss(i[f-1])}}else{[i[f]][0].cssArr["left"]=-(m-o.touches[0].clientX)+"px";[i[f+1]][0].cssArr["left"]=-(m-o.touches[0].clientX)+h+"px";[i[f+1]][0].cssArr["visibility"]="visible";[i[f+1]][0].cssArr["display"]="block";[i[f-1]][0].cssArr["left"]=-(m-o.touches[0].clientX)-h+"px";[i[f-1]][0].cssArr["visibility"]="visible";[i[f-1]][0].cssArr["display"]="block";l.instantiationCss(i[f+1]);l.instantiationCss(i[f-1])}}l.instantiationCss(i[f])}});a.getElementsByTagName("body")[0].addEventListener("touchend",function(o){o.preventDefault();if(j){if(m-o.changedTouches[0].clientY>=c/3){l.nextPage()}else{if(m-o.changedTouches[0].clientY<-c/3){l.previousPage()}else{[i[f]][0].cssArr["top"]="0";if(f!=0){[i[f-1]][0].cssArr["visibility"]="hidden";[i[f-1]][0].cssArr["display"]="none";l.instantiationCss(i[f-1])}if(f!=(i.length-1)){[i[f+1]][0].cssArr["visibility"]="hidden";[i[f+1]][0].cssArr["display"]="none";l.instantiationCss(i[f+1])}l.instantiationCss(i[f])}}}else{if(n-o.changedTouches[0].clientX>=h/3){l.nextPage()}else{if(n-o.changedTouches[0].clientX<-h/3){l.previousPage()}else{[i[f]][0].cssArr["left"]="0";if(f!=0){[i[f-1]][0].cssArr["visibility"]="hidden";[i[f-1]][0].cssArr["display"]="none";l.instantiationCss(i[f-1])}if(f!=(i.length-1)){[i[f+1]][0].cssArr["visibility"]="hidden";[i[f+1]][0].cssArr["display"]="none";l.instantiationCss(i[f+1])}l.instantiationCss(i[f])}}}})};this.previousPage=function(){if(f>0){[i[f]][0].cssArr["visibility"]="hidden";[i[f]][0].cssArr["display"]="none";[i[f]][0].cssArr["top"]="0";[i[f]][0].cssArr["left"]="0";l.instantiationCss(i[f]);f--;[i[f]][0].cssArr["top"]="0";[i[f]][0].cssArr["left"]="0";[i[f]][0].cssArr["visibility"]="visible";[i[f]][0].cssArr["display"]="block";l.instantiationCss(i[f]);b=0}else{[i[f]][0].cssArr["top"]="0";l.instantiationCss(i[f])}};this.nextPage=function(){if(f!=(i.length-1)){[i[f]][0].cssArr["visibility"]="hidden";[i[f]][0].cssArr["display"]="none";[i[f]][0].cssArr["top"]="0";[i[f]][0].cssArr["left"]="0";l.instantiationCss(i[f]);f++;[i[f]][0].cssArr["visibility"]="visible";[i[f]][0].cssArr["top"]="0";[i[f]][0].cssArr["left"]="0";[i[f]][0].cssArr["display"]="block";l.instantiationCss(i[f]);b=0}else{[i[f]][0].cssArr["top"]="0";[i[f]][0].cssArr["left"]="0";l.instantiationCss(i[f])}};this.instantiationCss=function(m){var o="";for(var n in [m][0].cssArr){o+=n+":"+[m][0].cssArr[n]+";"}m.style.cssText=o};this.instantiationAnimation=function(m){var o="";for(var n in [m][0].animationArr){o+=n+":"+[m][0].animationArr[n]+";"}m.style.cssText=o};this.story=function(){var o=0;for(var n in d){i[o]=l.dom(n);i[o].cssArr={};g[o]=[];if(o!=0){i[o].cssArr["visibility"]="hidden"}i[o].cssArr["position"]="fixed";i[o].cssArr["top"]="0";i[o].cssArr["left"]="0";i[o].cssArr["z-index"]=100-o;i[o].cssArr["overflow"]="hidden";l.instantiationCss(i[o]);
	k[o]={};for(var m in d[n]){l.makeActors(m,o,n,d[n][m].type,d[n][m].speed,d[n][m].route)}o++}};this.makeActors=function(s,r,q,m,n,u){var p=l.dom(s);m=m?m:"";n=typeof n==="number"?n:1000;u=u?u:0;var t=p.cloneNode(true);t.className+=" PPT#"+r+"#"+(g[r].length);l.dom(q).appendChild(t);p.id="old_"+p.id;k[r]=k[r]?k[r]:{};k[r][u]=k[r][u]?k[r][u]:[];k[r][u].push(g[r].length);g[r].push(t);var o=g[r][g[r].length-1];o.cssArr={};o.cssArr["position"]="absolute";o.cssArr["top"]=p.offsetTop+"px";o.cssArr["left"]=p.offsetLeft+"px";o.cssArr["transition"]="all "+(n/1000)+"s ease";o.cssArr["margin"]="0";o.animationArr={};o.animationArr["margin"]="0";if(m.indexOf("join-top")!=-1){o.animationArr["top"]="-"+p.offsetHeight+"px"}else{if(m.indexOf("join-bottom")!=-1){o.animationArr["top"]=c+p.offsetHeight+"px"}else{if(m.indexOf("out-top")!=-1){o.animationArr["top"]=o.cssArr["top"];o.cssArr["top"]="-"+p.offsetHeight+"px"}else{if(m.indexOf("out-bottom")!=-1){o.animationArr["top"]=o.cssArr["top"];o.cssArr["top"]=c+p.offsetHeight+"px"}else{o.animationArr["top"]=o.cssArr["top"]}}}}if(m.indexOf("join-left")!=-1){o.animationArr["left"]="-"+p.offsetWidth+"px"}else{if(m.indexOf("join-right")!=-1){o.animationArr["left"]=h+p.offsetWidth+"px"}else{if(m.indexOf("out-left")!=-1){o.animationArr["left"]=o.cssArr["left"];o.cssArr["left"]="-"+p.offsetWidth+"px"}else{if(m.indexOf("out-right")!=-1){o.animationArr["left"]=o.cssArr["left"];o.cssArr["left"]=h+p.offsetWidth+"px"}else{o.animationArr["left"]=o.cssArr["left"]}}}}if(m.indexOf("join-hiding")!=-1){o.animationArr["filter"]="alpha(opacity=0)";o.animationArr["-moz-opacity"]="0";o.animationArr["opacity"]="0"}if(m.indexOf("out-hiding")!=-1){o.cssArr["filter"]="alpha(opacity=0)";o.cssArr["-moz-opacity"]="0";o.cssArr["opacity"]="0"}o.animationArr["position"]="absolute";l.instantiationAnimation(o);p.style.cssText=p.style.cssText+"visibility:hidden; width:"+p.offsetWidth+"px; height:"+p.offsetHeight+"px";p.innerHTML=""};var b=0;this.play=function(){function m(){return function(){if(k[f][b]!="undefined"){for(var n in k[f][b]){l.instantiationCss(g[f][k[f][b][n]])}}b++}}setInterval(m(),100)};this.touchListener();this.initializeCss();this.story();this.play()};